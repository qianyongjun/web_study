!function(){var t,e,i,s,a,n;t=function(){var t=function(t){if(!t.dom)throw new Error("dom element can not be empty!");if(!t.data||!t.data.length)throw new Error("data must be an array and must have more than one element!");this._opts=t,this._setting(),this._renderHTML(),this._bindHandler()};return t.prototype._setting=function(){var t=this._opts;this.wrap=t.dom,this.data=t.data,this.type=t.type||"pic",this.isVertical=t.isVertical||!1,this.isOverspread=t.isOverspread||!1,this.duration=t.duration||2e3,this.initIndex=t.initIndex||0,this.fixPage=t.fixPage||!0,(this.initIndex>this.data.length-1||this.initIndex<0)&&(this.initIndex=0),this.slideIndex=this.slideIndex||this.initIndex||0,this.axis=this.isVertical?"Y":"X",this.reverseAxis="Y"===this.axis?"X":"Y",this.width=this.wrap.clientWidth,this.height=this.wrap.clientHeight,this.ratio=this.height/this.width,this.scale=t.isVertical?this.height:this.width,this.onslide=t.onslide,this.onslidestart=t.onslidestart,this.onslideend=t.onslideend,this.onslidechange=t.onslidechange,this.isLoading=t.isLoading,this.offset=this.offset||{X:0,Y:0},this.useZoom=t.useZoom||!1,this.data.length<2?(this.isLooping=!1,this.isAutoPlay=!1):(this.isLooping=t.isLooping||!1,this.isAutoplay=t.isAutoplay||!1),"card"===t.animateType&&this.isVertical&&(this.isOverspread=!0),this.isAutoplay&&this.play(),this.useZoom&&this._initZoom(t),this.log=t.isDebug?function(t){window.console.log(t)}:function(){},this._setUpDamping(),this._setPlayWhenFocus(),this._animateFunc=t.animateType in this._animateFuncs?this._animateFuncs[t.animateType]:this._animateFuncs["default"]},t.prototype._setPlayWhenFocus=function(){window.addEventListener("focus",this,!1),window.addEventListener("blur",this,!1)},t.prototype._animateFuncs={"default":function(t,e,i,s,a){t.style.webkitTransform="translateZ(0) translate"+e+"("+(a+i*(s-1))+"px)"}},t.prototype._setUpDamping=function(){var t=this.scale>>1,e=t>>1,i=e>>2;this._damping=function(s){var a,n=Math.abs(s);return a=t>n?n>>1:t+e>n?e+(n-t>>2):e+i+(n-t-e>>3),s>0?a:-a}},t.prototype._renderItem=function(t,e){var i,s,a=this.data.length,n=this,r=function(){s=i.height/i.width>n.ratio?'<img height="'+n.height+'" src="'+i.content+'">':'<img width="'+n.width+'" src="'+i.content+'">',t.innerHTML=s};if(i=this.isLooping?0>e?this.data[a+e]:e>a-1?this.data[e-a]:this.data[e]:this.data[e]||{empty:!0},i.empty)return t.innerHTML="",void(t.style.background="");if("pic"===this.type)if(this.isOverspread)t.style.background="url("+i.content+") 50% 50% no-repeat",t.style.backgroundSize="cover";else if(i.height&i.width)r();else{var o=new Image;o.src=i.content,o.onload=function(){i.height=o.height,i.width=o.width,r()}}else"dom"===this.type&&(t.innerHTML=i.content)},t.prototype._renderHTML=function(){this.outer&&(this.outer.innerHTML="");var t=this.outer||document.createElement("ul");if(t.className="islider-outer",t.style.cssText="height:"+this.height+"px;width:"+this.width+"px;margin:0;padding:0;list-style:none;","pic"===this.type&&!this.loader&&this.isLoading){var e=document.createElement("div");e.className="islider-loader",this.loader=e,this.wrap.appendChild(e)}this.els=[];for(var i=0;3>i;i++){var s=document.createElement("li");s.className="dom"===this.type?"islider-dom":"islider-pic",s.style.cssText="height:"+this.height+"px;width:"+this.width+"px;",this.els.push(s),this._animateFunc(s,this.axis,this.scale,i,0),!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?this._renderItem(s,i-1+this.slideIndex):this._renderItem(s,1-i+this.slideIndex),t.appendChild(s)}this._initLoadImg(),this.outer||(this.outer=t,this.wrap.appendChild(t))},t.prototype._preloadImg=function(t){var e=this.data.length,i=t,s=this,a=function(t){if(t>-1&&!s.data[t].loaded){var e=new Image;e.src=s.data[t].content,e.onload=function(){s.data[t].width=e.width,s.data[t].height=e.height},s.data[t].loaded=1}};if("dom"!==s.type&&e>3){var n=i+2>e-1?(i+2)%e:i+2,r=0>i-2?e-2+i:i-2;a(n),a(r)}},t.prototype._initLoadImg=function(){var t=this.data,e=t.length,i=this.slideIndex,s=this;if("dom"!==this.type&&e>3){var a=i+2>e?(i+1)%e:i+1,n=0>i-1?e-1+i:i-1;t[i].loaded=1,t[a].loaded=1,s.isLooping&&(t[n].loaded=1),setTimeout(function(){s._preloadImg(i)},200)}},t.prototype.slideTo=function(t){var e=this.data,i=this.els,s=t,a=t-this.slideIndex;if(Math.abs(a)>1){var n=a>0?this.els[2]:this.els[0];this._renderItem(n,s)}this._preloadImg(s),e[s]?this.slideIndex=s:this.isLooping?this.slideIndex=a>0?0:e.length-1:(this.slideIndex=this.slideIndex,a=0),this.log("pic idx:"+this.slideIndex);var r;!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?a>0?(r=i.shift(),i.push(r)):0>a&&(r=i.pop(),i.unshift(r)):a>0?(r=i.pop(),i.unshift(r)):0>a&&(r=i.shift(),i.push(r)),0!==a&&(Math.abs(a)>1?(this._renderItem(i[0],s-1),this._renderItem(i[2],s+1)):1===Math.abs(a)&&this._renderItem(r,s+a),r.style.webkitTransition="none",r.style.visibility="hidden",setTimeout(function(){r.style.visibility="visible"},200),this.onslidechange&&this.onslidechange(this.slideIndex),this.dotchange&&this.dotchange());for(var o=0;3>o;o++)i[o]!==r&&(i[o].style.webkitTransition="all .3s ease"),this._animateFunc(i[o],this.axis,this.scale,o,0);this.isAutoplay&&!this.isLooping&&this.slideIndex===e.length-1&&this.pause()},t.prototype._device=function(){var t=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),e=t?"touchstart":"mousedown",i=t?"touchmove":"mousemove",s=t?"touchend":"mouseup";return{hasTouch:t,startEvt:e,moveEvt:i,endEvt:s}},t.prototype._bindHandler=function(){var t=this.outer,e=this._device();e.hasTouch||(t.style.cursor="pointer",t.ondragstart=function(t){return t?!1:!0}),t.addEventListener(e.startEvt,this),t.addEventListener(e.moveEvt,this),t.addEventListener(e.endEvt,this),window.addEventListener("orientationchange",this)},t.prototype.bind=t.prototype.delegate=function(t,e,i){function s(t){for(var s=window.event?window.event:t,a=s.target,n=document.querySelectorAll(e),r=0;r<n.length;r++)if(a===n[r]){i.call(a);break}}this.wrap.addEventListener(t,s,!1)},t.prototype.destroy=function(){var t=this.outer,e=this._device();t.removeEventListener(e.startEvt,this),t.removeEventListener(e.moveEvt,this),t.removeEventListener(e.endEvt,this),window.removeEventListener("orientationchange",this),window.removeEventListener("focus",this),window.removeEventListener("blur",this),this.wrap.innerHTML=""},t.prototype.handleEvent=function(t){var e=this._device();switch(t.type){case e.startEvt:this.startHandler(t);break;case e.moveEvt:this.moveHandler(t);break;case e.endEvt:this.endHandler(t);break;case"touchcancel":this.endHandler(t);break;case"orientationchange":this.orientationchangeHandler();break;case"focus":this.isAutoplay&&this.play();break;case"blur":this.pause()}},t.prototype.startHandler=function(t){if(this.fixPage){var e=t.target;"SELECT"!==e.tagName&&"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&t.preventDefault()}var i=this._device();this.isMoving=!0,this.pause(),this.onslidestart&&this.onslidestart(),this.log("Event: beforeslide"),this.startTime=(new Date).getTime(),this.startX=i.hasTouch?t.targetTouches[0].pageX:t.pageX,this.startY=i.hasTouch?t.targetTouches[0].pageY:t.pageY,this._startHandler&&this._startHandler(t)},t.prototype.moveHandler=function(t){if(this.isMoving){var e=this._device(),i=this.data.length,s=this.axis,a=this.reverseAxis,n={X:e.hasTouch?t.targetTouches[0].pageX-this.startX:t.pageX-this.startX,Y:e.hasTouch?t.targetTouches[0].pageY-this.startY:t.pageY-this.startY},r=this._moveHandler?this._moveHandler(t):!1;if(!r&&Math.abs(n[s])-Math.abs(n[a])>10){t.preventDefault(),this.onslide&&this.onslide(n[s]),this.log("Event: onslide"),this.isLooping||(n[s]>0&&0===this.slideIndex||n[s]<0&&this.slideIndex===i-1)&&(n[s]=this._damping(n[s]));for(var o=0;3>o;o++){var h=this.els[o];h.style.webkitTransition="all 0s",this._animateFunc(h,s,this.scale,o,n[s])}}this.offset=n}},t.prototype.endHandler=function(t){this.isMoving=!1;var e=this.offset,i=this.axis,s=this.scale/2,a=(new Date).getTime();s=a-this.startTime>300?s:14;var n=this._endHandler?this._endHandler(t):!1,r=Math.abs(e[i]),o=Math.abs(e[this.reverseAxis]),h=function(t){if("A"===t.tagName){if(t.href)return window.location.href=t.href,!1}else{if("islider-dom"===t.className)return!1;h(t.parentNode)}};!n&&e[i]>=s&&r>o?this.slideTo(this.slideIndex-1):!n&&e[i]<-s&&r>o?this.slideTo(this.slideIndex+1):n||this.slideTo(this.slideIndex),Math.abs(this.offset.X)<10&&Math.abs(this.offset.Y)<10&&(this.tapEvt=document.createEvent("Event"),this.tapEvt.initEvent("tap",!0,!0),this.fixPage&&"dom"===this.type&&h(t.target),t.target.dispatchEvent(this.tapEvt)||t.preventDefault()),this.offset.X=this.offset.Y=0,this.isAutoplay&&this.play(),this.onslideend&&this.onslideend(this.slideIndex),this.log("Event: afterslide")},t.prototype.orientationchangeHandler=function(){var t=this;setTimeout(function(){t.reset(),t.log("Event: orientationchange")},100)},t.prototype.reset=function(){this.pause(),this._setting(),this._renderHTML(),this.isAutoplay&&this.play()},t.prototype.loadData=function(t,e){this.pause(),this.slideIndex=e||0,this.data=t,this._renderHTML(),this.isAutoplay&&this.play()},t.prototype.play=function(){var t=this,e=this.duration;clearInterval(this.autoPlayTimer),this.autoPlayTimer=setInterval(function(){t.slideTo(t.slideIndex+1)},e)},t.prototype.pause=function(){clearInterval(this.autoPlayTimer)},t.prototype.extend=function(e,i){i||(i=t.prototype),Object.keys(e).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})},t}(),e=void 0,i=function(t){var e={rotate:function(t,e,i,s,a){var n="X"===e?"Y":"X",r=Math.abs(a),o=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;this.isVertical&&(a=-a),this.wrap.style.webkitPerspective=4*i,t.style.zIndex=1===s?i-r:a>0?(1-s)*r:(s-1)*r,t.style.cssText+="-webkit-backface-visibility:hidden; -webkit-transform-style:preserve-3d; background-color:"+o+"; position:absolute;",t.style.webkitTransform="rotate"+n+"("+90*(a/i+s-1)+"deg) translateZ("+.888*i/2+"px) scale(0.888)"},flip:function(t,e,i,s,a){var n="X"===e?"Y":"X",r=window.getComputedStyle(this.wrap.parentNode,null).backgroundColor;this.isVertical&&(a=-a),this.wrap.style.webkitPerspective=4*i,t.style.visibility=a>0?s>1?"hidden":"visible":1>s?"hidden":"visible",t.style.cssText+="position:absolute; -webkit-backface-visibility:hidden; background-color:"+r+";",t.style.webkitTransform="translateZ("+i/2+"px) rotate"+n+"("+180*(a/i+s-1)+"deg) scale(0.875)"},depth:function(t,e,i,s,a){var n=.18*(4-Math.abs(s-1));this.wrap.style.webkitPerspective=4*i,t.style.zIndex=1===s?100:a>0?1-s:s-1,t.style.webkitTransform="scale("+n+", "+n+") translateZ(0) translate"+e+"("+(a+1.3*i*(s-1))+"px)"},flow:function(t,e,i,s,a){var n=Math.abs(a),r="X"===e?"Y":"X",o="X"===e?1:-1,h=Math.abs(a/i);this.wrap.style.webkitPerspective=4*i,t.style.zIndex=1===s?i-n:a>0?(1-s)*n:(s-1)*n,t.style.webkitTransform="scale(0.7, 0.7) translateZ("+(150*h-150)*Math.abs(s-1)+"px)translate"+e+"("+(a+i*(s-1))+"px)rotate"+r+"("+o*(30-30*h)*(1-s)+"deg)"},card:function(t,e,i,s,a){var n=Math.abs(a);1===s?(t.style.zIndex=i-n,t.cur=1):t.style.zIndex=a>0?(1-s)*n*1e3:(s-1)*n*1e3,t.cur&&t.cur!==s&&setTimeout(function(){t.cur=null},300);var r=t.cur?1-.2*Math.abs(s-1)-Math.abs(.2*a/i).toFixed(6):1;t.style.webkitTransform="scale("+r+", "+r+") translateZ(0) translate"+e+"("+((1+.2*Math.abs(s-1))*a+i*(s-1))+"px)"}};t.prototype.extend(e,t.prototype._animateFuncs)}(t),s=function(t){function e(t,e,i,s){return"translate"+(w?"3d(":"(")+t+"px,"+e+(w?"px,"+i+"px)":"px)")+"scale("+s+")"}function i(t,e){var i,s;return i=t.left-e.left,s=t.top-e.top,Math.sqrt(i*i+s*s)}function s(t,e){return t+"px "+e+"px"}function a(t){return Array.prototype.slice.call(t).map(function(t){return{left:t.pageX,top:t.pageY}})}function n(t,e){var s=i(t[0],t[1]),a=i(e[0],e[1]);return a/s}function r(t){var e={translateX:0,translateY:0,translateZ:0,scaleX:1,scaleY:1,offsetX:0,offsetY:0},i=0,s=0;if(!window.getComputedStyle||!t)return e;var a,n,r=window.getComputedStyle(t);a=r.webkitTransform||r.mozTransform,n=r.webkitTransformOrigin||r.mozTransformOrigin;var o=n.match(/(.*)px\s+(.*)px/);if(o.length>1&&(i=o[1]-0,s=o[2]-0),"none"==a)return e;var h=a.match(/^matrix3d\((.+)\)$/),l=a.match(/^matrix\((.+)\)$/);if(h){var d=h[1].split(", ");e={translateX:d[12]-0,translateY:d[13]-0,translateZ:d[14]-0,offsetX:i-0,offsetY:s-0,scaleX:d[0]-0,scaleY:d[5]-0,scaleZ:d[10]-0}}else if(l){var d=l[1].split(", ");e={translateX:d[4]-0,translateY:d[5]-0,offsetX:i-0,offsetY:s-0,scaleX:d[0]-0,scaleY:d[3]-0}}return e}function o(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function h(t){this.currentScale=1,this.zoomFactor=t.zoomFactor||2}function l(t){if(this.useZoom){var e=this.els[1].querySelector("img"),i=r(e);this.startTouches=a(t.targetTouches),this._startX=i.translateX-0,this._startY=i.translateY-0,this.currentScale=i.scaleX,this.zoomNode=e;var n=m(e);if(2==t.targetTouches.length){console.log("gesture"),this.lastTouchStart=null;var h=t.touches,l=o({x:h[0].pageX,y:h[0].pageY},{x:h[1].pageX,y:h[1].pageY});e.style.webkitTransformOrigin=s(l.x-n.left,l.y-n.top)}else if(1===t.targetTouches.length){var d=(new Date).getTime();this.gesture=0,d-this.lastTouchStart<300&&(t.preventDefault(),this.gesture=3),this.lastTouchStart=d}}}function d(t){var e=0,i=this.zoomNode,s=this._device();return s.hasTouch?(2===t.targetTouches.length&&this.useZoom?(i.style.webkitTransitionDuration="0",t.preventDefault(),this._scaleImage(t),e=2):1==t.targetTouches.length&&this.useZoom&&this.currentScale>1&&(i.style.webkitTransitionDuration="0",t.preventDefault(),this._moveImage(t),e=1),this.gesture=e,e):void 0}function c(t){var i=this.zoomFactor||2,a=this.zoomNode,n=m(a);this.currentScale=1==this.currentScale?i:1,a.style.webkitTransform=e(0,0,0,this.currentScale),1!=this.currentScale&&(a.style.webkitTransformOrigin=s(t.touches[0].pageX-n.left,t.touches[0].pageY-n.top))}function p(t){var i=a(t.targetTouches),s=n(this.startTouches,i);t.scale=t.scale||s;var r=this.zoomNode;s=this.currentScale*t.scale<b?b:this.currentScale*t.scale,r.style.webkitTransform=e(0,0,0,s)}function u(t){var e=0;return 2===this.gesture?(this._resetImage(t),e=2):1==this.gesture?(this._resetImage(t),e=1):3===this.gesture&&(this._handleDoubleTap(t),this._resetImage(t)),e}function f(t){var i=this.zoomNode,s=this._device(),a={X:s.hasTouch?t.targetTouches[0].pageX-this.startX:t.pageX-this.startX,Y:s.hasTouch?t.targetTouches[0].pageY-this.startY:t.pageY-this.startY};this.moveOffset={x:this._startX+a.X-0,y:this._startY+a.Y-0},i.style.webkitTransform=e(this.moveOffset.x,this.moveOffset.y,0,this.currentScale)}function m(t){var e={left:0,top:0};do e.top+=t.offsetTop||0,e.left+=t.offsetLeft||0,t=t.offsetParent;while(t);return e}function v(t,e,i){var s,a,n=m(t);T={start:{left:n.left,top:n.top},end:{left:n.left+t.clientWidth,top:n.top+t.clientHeight}};var r=1==i?"left":"top";return s=T.start[r],a=T.end[r],e>=s&&a>=e}function g(t,e){var i=0,s=v(t,e.start.left,1),a=v(t,e.end.left,1),n=v(t,e.start.top,0),r=v(t,e.end.top,0);return s!=a&&n!=r?i=s&&r?1:s&&n?2:a&&r?3:4:s==a?!n&&r?i=5:!r&&n&&(i=6):n==r?!s&&a?i=7:s&&!a&&(i=8):n==r==s==a&&(i=9),i}function y(t){if(1!=this.currentScale){var i,s,a,n,o,h,l,d,c,p,u=this.zoomNode;switch(a=r(u),c=u.parentNode,n=u.clientWidth*a.scaleX,o=u.clientHeight*a.scaleX,h=m(u),l={left:(1-a.scaleX)*a.offsetX+h.left+a.translateX,top:(1-a.scaleX)*a.offsetY+h.top+a.translateY},d={left:l.left+n,top:l.top+o},i=l.left,s=l.top,p=g(c,{start:l,end:d})){case 1:i=T.start.left,s=T.end.top-o;break;case 2:i=T.start.left,s=T.start.top;break;case 3:i=T.end.left-n,s=T.end.top-o;break;case 4:i=T.end.left-n,s=T.start.top;break;case 5:s=T.end.top-o;break;case 6:s=T.start.top;break;case 7:i=T.end.left-n;break;case 8:i=T.start.left}n<c.clientWidth&&(i=h.left-(a.scaleX-1)*u.clientWidth/2),o<c.clientHeight&&(s=h.top-(a.scaleX-1)*u.clientHeight/2),u.style.webkitTransitionDuration="100ms",u.style.webkitTransform=e(a.translateX+i-l.left,a.translateY+s-l.top,0,a.scaleX)}}var w="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,b=.5,T={};t.prototype.extend({_initZoom:h,_scaleImage:p,_moveImage:f,_resetImage:y,_handleDoubleTap:c,_moveHandler:d,_endHandler:u,_startHandler:l})}(t),a=function(t){t.prototype.extend({addBtn:function(){if(!this.isVertical)for(var t=[],e=[],i=this,s=0;2>s;s++)t[s]=document.createElement("div"),t[s].className="islider-btn-outer",e[s]=document.createElement("div"),e[s].className="islider-btn-inner",0===s?(t[s].className+=" left",t[s].dir=-1):(t[s].className+=" right",t[s].dir=1),t[s].addEventListener("click",function(){var t=parseInt(this.getAttribute("dir"),10);i.slideTo(i.slideIndex+t)}),t[s].appendChild(e[s]),this.wrap.appendChild(t[s],this.wrap.nextSibling)}})}(t),n=function(t){t.prototype.extend({addDot:function(){if(!this.isVertical){var t=this,e=this.data,i=[],s=document.createElement("ul");s.className="islider-dot-wrap";for(var a=document.createDocumentFragment(),n=0;n<e.length;n++)i[n]=document.createElement("li"),i[n].className="islider-dot",i[n].setAttribute("index",n),n===this.slideIndex&&(i[n].className+=" active"),i[n].addEventListener("click",function(){var e=parseInt(this.getAttribute("index"),10);t.slideTo(e)}),a.appendChild(i[n]);s.appendChild(a),this.wrap.parentNode.appendChild(s),this.dotchange=function(){for(var t=0;t<e.length;t++)i[t].className="islider-dot",t===this.slideIndex&&(i[t].className+=" active")}}}})}(t),window.iSlider=t}();